<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:lm="http://lukasmacko.sk/test"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:a4j="http://richfaces.org/a4j">
    <h:head>
        <title>Use my chart</title>
        <style type="text/css">
            .chart{
                width: 600px;
                height: 400px;
            }
        </style>
        <script type="text/javascript">
            //<![CDATA[  
            function click(e,type){
                console.log(type+' chart');
                $("#info").html("client-side update");
                console.log(e.data);
            }
                      
            function highlight(e){
                $("#mouseover-info").html("Series: "+e.data.seriesIndex+" RowKey:"+e.data.pointIndex+" Label:"
                    +e.data.x+" Value:"+e.data.y); 
            }
            
            function unhighlight(e){
                $("#mouseover-info").html("-"); 
            }
            
            function log(e,type){
                console.log(type)
                console.log(e.data);
            }
            //]]>
        </script>

    </h:head>
    <h:body>

        <a4j:outputPanel ajaxRendered="true" >
            <h:messages/>
        </a4j:outputPanel>
            <lm:chart id="lineChart" title="My title hey hou!" styleClass="chart" ondataclick="click(event,'line')" 
                      onhighlight="highlight(event)" onunhighlight="unhighlight(event)"
                      ondragstart="log(event,'dragStart')" ondragstop="log(event,'dragStop')" onpointmove="log(event,'move')"
                      dataClickListener="#{myBean.dataclick}"
                      dragStopListener="#{myBean.dragStopHandler}">
                <lm:series value="#{myBean.first}" type="line" label="Dragable" color="green" dragable="true" dragableConstraint="y" trendlineVisible="true"/>
                <lm:series value="#{myBean.second}" type="line" label="Second" marker="filledDiamond"/>
                <lm:xaxis label="xaxis label"/>
                <lm:yaxis label="yaxis label" />
                <lm:legend placement="outside"/>
                <a4j:ajax event="dataclick" render="msg" execute="msg"/>
                <a4j:ajax event="dragstop" render="draglog" execute="draglog"/>
            </lm:chart>

            <div id="info"></div>
            

            <h:form>
                <h:outputText value="#{myBean.msg}" id="msg"/>
                <h:outputText value="#{myBean.dragLog}" id="draglog"/>
            </h:form>

            <h:form>
                <a4j:poll id="poll" interval="5000" enabled="false" render="barChart" actionListener="#{myBean.generateRandom()}"/>
            </h:form>

            <lm:chart id="barChart" styleClass="chart"  ondataclick="click(event,'bar')" onhighlight="highlight(event)" onunhighlight="unhighlight(event)">
                <lm:series value="#{myBean.barData}" type="bar" label="old" color="yellow" dragable="true" dragableConstraint="y"/>
                <lm:series value="#{myBean.barData2}" type="bar" label="new"/>
                <lm:legend position="top"/>
            </lm:chart>

            <div id="mouseover-info"></div>

            <lm:chart id="pieChart" title="Pie demo" styleClass="chart" ondataclick="click(event,'pie')"
                      onhighlight="highlight(event)" onunhighlight="unhighlight(event)"
                      dataClickListener="#{myBean.dataclick}">
                <lm:series value="#{myBean.pieData}" type="pie" />
                <lm:legend position="left"/>
                <a4j:ajax event="dataclick" render="msg" execute="msg"/>
            </lm:chart>
    </h:body>
</html>
